(this["webpackJsonpsite-xml-read"]=this["webpackJsonpsite-xml-read"]||[]).push([[0],{19:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(11),i=n.n(c),o=n(2),s=n(5),l=n(3),d=n(0),b=r.a.createContext({}),j=function(e){var t=e.children,n=Object(a.useState)(null),r=Object(l.a)(n,2),c=r[0],i=r[1];return Object(d.jsx)(b.Provider,{value:{jwt:c,setJWT:i},children:t})},u=b,m=n(6),x=n.n(m),h=n(9),p=function(){var e=Object(h.a)(x.a.mark((function e(t){var n,a,r,c,i;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.username,a=t.password,e.next=3,fetch("".concat("http://209.126.12.58/api/backendxmlreader","/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:n,password:a})});case 3:if((r=e.sent).ok){e.next=6;break}throw new Error("Response is not ok!");case 6:return e.next=8,r.json();case 8:return c=e.sent,i=c.token,e.abrupt("return",i);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(a.useContext)(u),t=e.jwt,n=e.setJWT,r=Object(a.useState)({loading:!1,error:!1}),c=Object(l.a)(r,2),i=c[0],o=c[1],s=Object(a.useCallback)((function(e){var t=e.username,a=e.password;o({loading:!0,error:!1}),p({username:t,password:a}).then((function(e){o({loading:!1,error:!1}),n(e)})).catch((function(e){o({loading:!1,error:!0})}))}),[n]),d=Object(a.useCallback)((function(){n(null)}),[n]);return{isLogged:Boolean(t),isLoginLoading:i.loading,hasLoginError:i.error,login:s,logout:d}},f=function(){var e=O(),t=e.isLogged,n=e.logout;return Object(d.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark bg-dark",children:Object(d.jsxs)("div",{className:"container-fluid",children:[Object(d.jsx)("div",{className:"navbar-brand",children:Object(d.jsx)(s.b,{className:"link-light ",style:{outline:"none"},to:"/",children:"XML Reader"})}),Object(d.jsx)("div",{className:"d-flex justify-content-end",children:Object(d.jsx)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0",children:Object(d.jsx)("li",{className:"nav-item",children:t?Object(d.jsx)(s.b,{className:"nav-link active btn btn-link",to:"#",onClick:function(){return n()},children:"Logout"}):Object(d.jsx)(s.b,{className:"nav-link active btn btn-link",to:"login",children:"Login"})})})})]})})},g=function(){var e=Object(a.useState)(""),t=Object(l.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)(""),i=Object(l.a)(c,2),s=i[0],b=i[1],j=O(),u=j.login,m=j.isLogged,x=j.isLoginLoading,h=j.hasLoginError,p=Object(o.f)();Object(a.useEffect)((function(){m&&p("/")}),[m,p]);return Object(d.jsxs)(d.Fragment,{children:[x&&Object(d.jsx)("strong",{children:"Verificando credenciales..."}),!x&&Object(d.jsx)("form",{onSubmit:function(e){e.preventDefault(),u({username:n,password:s})},children:Object(d.jsx)("div",{className:"card mb-3",children:Object(d.jsxs)("div",{className:"card-body",children:[Object(d.jsxs)("div",{className:"mb-3",children:[Object(d.jsx)("label",{htmlFor:"username",className:"form-label",children:"Usuario"}),Object(d.jsx)("input",{type:"text",className:"form-control",id:"username",placeholder:"Usuario",onChange:function(e){return r(e.target.value)},value:n})]}),Object(d.jsxs)("div",{className:"mb-3",children:[Object(d.jsx)("label",{htmlFor:"password",className:"form-label",children:"Contrase\xf1a"}),Object(d.jsx)("input",{type:"password",className:"form-control",id:"password",placeholder:"password",onChange:function(e){return b(e.target.value)},value:s})]}),Object(d.jsx)("button",{className:"btn btn-success",children:"Entrar"})]})})}),h&&Object(d.jsx)("div",{className:"alert alert-danger",role:"alert",children:Object(d.jsx)("strong",{children:"Credenciales no v\xe1lidas!!!"})})]})},v=function(){return Object(d.jsx)("div",{children:"Register"})},C=n(12),y={color:"#fff",padding:"50px",backgroundColor:"rgba(255,255,255,0.4)",borderColor:"rgba(255,255,255,0.9)",borderStyle:"dashed",borderWidth:"thick",fontSize:"3.5rem",textAlign:"center",fontWeight:"bold"},N={color:"#000",padding:"50px",backgroundColor:"rgba(255,255,255,0.2)",borderColor:"rgba(24,24,24,0.3)",borderStyle:"dashed",borderWidth:"thick",fontSize:"3.5rem",textAlign:"center",fontWeight:"bold"},E=function(e,t){var n="",a=t.Descripcion.replace(/(\n)/g," ");return n+="[".concat(e,"]"),n+="\n",n+="BienesTransp=".concat(t.BienesTransp),n+="\n",n+="Descripcion=".concat(a),n+="\n",n+="Cantidad=".concat(t.Cantidad),n+="\n",n+="ClaveUnidad=".concat(t.ClaveUnidad),n+="\n",n+="Unidad=".concat(t.Unidad),n+="\n",n+="CveMaterialPeligroso=".concat(t.CveMaterialPeligroso),n+="\n",n+="Embalaje=".concat(t.Embalaje),n+="\n",n+="DescripEmbalaje=".concat(t.DescripEmbalaje),n+="\n",n+="PesoEnKg=".concat(t.PesoEnKg),n+="\n",n+="ValorMercancia=".concat(t.ValorMercancia),n+="\n",n+="Moneda=".concat(t.Moneda),n+="\n",n+="FraccionArancelaria=".concat(t.FraccionArancelaria),n+="\n",n+="UUIDComercioExt=".concat(t.UUIDComercioExt),n+="\n",(n+="Pedimentos=".concat(t.Pedimentos))+"\n"},k=function(){var e=Object(a.useState)(!1),t=Object(l.a)(e,2),n=t[0],r=t[1],c=Object(a.useState)([]),i=Object(l.a)(c,2),o=i[0],s=i[1],b=Object(a.useState)("FileGenerated.ini"),j=Object(l.a)(b,2),u=j[0],m=j[1];Object(a.useEffect)((function(){var e;m((e="nameFile",localStorage.getItem(e)))}),[u]);var p=function(){var e=Object(h.a)(x.a.mark((function e(){var t,n,a,c,i,l,d;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(t="",n=0;n<o.length;n++)t+=E(n,o[n]);a=(new Date).getTime(),c=new Blob([t],{type:"text/plain;charset=utf-8;"}),i=u,console.log(i.split(".")[0]),navigator.msSaveBlob?(navigator.msSaveBlob(c,"".concat(u.split(".")[0],"_").concat(a,".").concat(u.split(".")[1])),s([])):void 0!==(l=document.createElement("a")).download&&(d=URL.createObjectURL(c),l.setAttribute("href",d),l.setAttribute("download","".concat(u.split(".")[0],"_").concat(a,".").concat(u.split(".")[1])),l.style.visibility="hidden",document.body.appendChild(l),l.click(),document.body.removeChild(l),s([]),r(!1));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(e){Array.from(e).filter((function(e){return"text/xml"===e.type})).forEach(function(){var e=Object(h.a)(x.a.mark((function e(t){var n,a,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.text();case 2:n=e.sent,a=n,r=new DOMParser,r.parseFromString(a,"application/xml").activeElement.children[2].childNodes.forEach((function(e){if("cfdi:Concepto"===e.nodeName){var t={BienesTransp:e.attributes.ClaveProdServ.nodeValue,Descripcion:e.attributes.Descripcion.nodeValue,Cantidad:e.attributes.Cantidad.nodeValue,ClaveUnidad:e.attributes.ClaveUnidad.nodeValue,Unidad:e.attributes.Unidad.nodeValue,CveMaterialPeligroso:"",Embalaje:"",DescripEmbalaje:"",PesoEnKg:"",ValorMercancia:"",Moneda:"",FraccionArancelaria:"",UUIDComercioExt:"",Pedimentos:""};s((function(e){return[].concat(Object(C.a)(e),[t])}))}}));case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{className:"card text-white bg-secondary mb-3",children:[Object(d.jsx)("div",{className:"card-header",children:"\xc1rea de Archivos"}),Object(d.jsx)("div",{className:"card-body",children:Object(d.jsx)("div",{style:n?y:N,onDragEnter:function(){r(!0),s([])},onDragLeave:function(){r(!1)},onDragOver:function(e){e.preventDefault()},onDrop:function(e){e.preventDefault(),O(e.dataTransfer.files)},onClick:function(e){e.preventDefault(),document.getElementById("imgupload").click()},children:"Coloca aqu\xed tu archivo"})})]}),Object(d.jsxs)("div",{className:"w100",children:[Object(d.jsx)("label",{htmlFor:"nameFile",children:"Nombre para archivo generado"}),Object(d.jsx)("input",{type:"text",id:"nameFile",className:"form-control mb-3",placeholder:"Default: "+u.split(".")[0],onInput:function(e){var t=e.target.value;t=t.replace(/ /g,"_"),m("".concat(t,".ini")),localStorage.setItem("nameFile",JSON.stringify("".concat(t,".ini")))}}),Object(d.jsx)("input",{type:"file",id:"imgupload",style:{display:"none"},onClick:function(){return s([])},onChange:function(e){return O(e.target.files)},multiple:!0}),Object(d.jsx)("div",{className:"d-grid gap-2",children:Object(d.jsx)("button",{className:"btn btn-info btn",onClick:function(){return p()},disabled:!o.length>0,children:"Generar Archivo"})})]}),o.length>0&&Object(d.jsxs)("div",{className:"card text-white bg-primary mb-3 mt-3",children:[Object(d.jsx)("div",{className:"card-header",children:"Vista previa"}),Object(d.jsx)("div",{className:"card-body",children:Object(d.jsx)("div",{className:"card-text bg-light text-secondary",children:Object(d.jsx)("ul",{children:o.map((function(e,t){return Object(d.jsxs)("li",{style:{listStyleType:"none"},children:["[",t,"]",Object(d.jsx)("br",{}),"BienesTransp=",e.BienesTransp,Object(d.jsx)("br",{}),"Descripcion=",e.Descripcion,Object(d.jsx)("br",{}),"Cantidad=",e.Cantidad,Object(d.jsx)("br",{}),"ClaveUnidad=",e.ClaveUnidad,Object(d.jsx)("br",{}),"Unidad=",e.Unidad,Object(d.jsx)("br",{}),"CveMaterialPeligroso=",e.CveMaterialPeligroso,Object(d.jsx)("br",{}),"Embalaje=",e.Embalaje,Object(d.jsx)("br",{}),"DescripEmbalaje=",e.DescripEmbalaje,Object(d.jsx)("br",{}),"PesoEnKg=",e.PesoEnKg,Object(d.jsx)("br",{}),"ValorMercancia=",e.ValorMercancia,Object(d.jsx)("br",{}),"Moneda=",e.Moneda,Object(d.jsx)("br",{}),"FraccionArancelaria=",e.FraccionArancelaria,Object(d.jsx)("br",{}),"UUIDComercioExt=",e.UUIDComercioExt,Object(d.jsx)("br",{}),"Pedimentos=",e.Pedimentos,Object(d.jsx)("br",{})]},t)}))})})})]})]})},w=function(){var e=O().isLogged,t=Object(o.f)();return Object(a.useEffect)((function(){e&&t("/")}),[e,t]),Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(f,{}),Object(d.jsx)("div",{className:"container mt-4",children:Object(d.jsxs)(o.c,{children:[Object(d.jsx)(o.a,{path:"/",element:e?Object(d.jsx)(k,{}):Object(d.jsx)(g,{})}),Object(d.jsx)(o.a,{path:"/register",element:Object(d.jsx)(v,{})}),Object(d.jsx)(o.a,{path:"/login",element:Object(d.jsx)(g,{})})]})})]})};var D=function(){return Object(d.jsx)(j,{children:Object(d.jsx)(s.a,{children:Object(d.jsx)(w,{})})})};i.a.render(Object(d.jsx)(D,{}),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.1f3a319b.chunk.js.map